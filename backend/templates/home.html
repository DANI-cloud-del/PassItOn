<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PassItOn - Share What You Don't Need</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='carousel.css') }}">
    <!-- No carousel-related CSS in the style tag -->
</head>
<body>
    <!-- Initial loading screen with motto -->
    <div class="loading-screen" id="loadingScreen">
        <div class="motto-container">
            <p class="motto">Give what you don't need. Get what you do.</p>
        </div>
    </div>
    
   <header>
    <div class="logo">
        <span>PassItOn</span>
    </div>
    
    <div class="search-container">
        <input type="text" class="search-bar" placeholder="Search for items...">
    </div>
    
    <div class="nav-icons">
        <button class="icon-btn" id="themeToggle" title="Toggle Theme">
            <i class="fas fa-moon"></i>
        </button>
        
        <button class="icon-btn" id="makeRequestBtn" title="Make a Request">
            <i class="fas fa-plus-circle"></i>
        </button>
        
        <button class="icon-btn" id="addToCartBtn" title="Cart">
            <i class="fas fa-shopping-cart"></i>
            <span class="notification-badge" id="cartCount" style="display: none;">0</span>
        </button>
        
        <button class="icon-btn" id="loginBtn" title="Login">Login</button>
        
        <!-- Notification bell with dropdown top-down -->
        <div class="dropdown icon-btn" id="notificationDropdown" style="position: relative;">
            <button id="notificationBtn" title="Notifications" style="background:none; border:none; color:inherit; font-size: 1.3rem; cursor:pointer; position: relative;">
                <i class="fas fa-bell"></i>
                <span class="notification-badge" id="notificationCount">3</span>
            </button>
            <div class="dropdown-content" id="notificationContent" style="display:none; position: absolute; right: 0; top: 110%; background: var(--card-bg); border-radius: 8px; box-shadow: 0 8px 16px rgba(0,0,0,0.2); max-width: 300px; max-height: 350px; overflow-y: auto; z-index: 25; padding: 12px; font-size: 0.9rem;">
                <ul id="notificationList" style="list-style:none; padding:0; margin:0;">
                    <!-- notifications will be dynamically loaded here -->
                </ul>
            </div>
        </div>
    </div>
</header>



    
    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <section class="hero">
            <h1>Welcome to PassItOn</h1>
            <p>A community marketplace for sharing items among hostel students</p>
        </section>
        
        <!-- 3D Carousel Section - Style comes from carousel.css only -->
        <div class="carousel-container" id="carouselContainer">
            <!-- Carousel cards will be loaded here -->
            
            <button class="carousel-nav-btn prev" id="carouselPrev">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="carousel-nav-btn next" id="carouselNext">
                <i class="fas fa-chevron-right"></i>
            </button>
            
            <div class="carousel-dots" id="carouselDots">
                <!-- Navigation dots will be loaded here -->
            </div>
        </div>
        <section class="top-deals-section" style="margin-top: 144px;">
  <h2 class="section-title">Top Deals</h2>
  <div style="max-width: 1200px; margin: 30px auto; text-align: right;">
    <a href="{{ url_for('sell_item') }}" class="btn-primary" style="padding: 10px 18px; border-radius: 25px; font-weight: 600; text-decoration: none;">
      <i class="fas fa-plus"></i> Sell Your Items
    </a>
  </div>
  <div class="deals-container">
    {% for deal in top_deals %}
    <div class="deal-card">
      <div class="deal-img" style="background-color: {{ deal.color }};">
        <i class="fas fa-{{ deal.icon }}"></i>
      </div>
      <div class="deal-details">
        <h3>{{ deal.title }}</h3>
        <p>{{ deal.description }}</p>
        <a href="#" class="deal-button">Grab Deal</a>
      </div>
    </div>
    {% endfor %}
  </div>
</section>



    <section class="announcement-box" style="max-width: 800px; margin: 40px auto; padding: 16px; background: var(--card-bg); border-radius: 12px; box-shadow: 0 3px 15px rgba(0,0,0,0.1);">
    <h3 style="color: var(--primary); margin-bottom: 12px;">Latest Announcements</h3>
    <ul style="list-style: disc inside; color: var(--text); max-height: 140px; overflow-y: auto;">
        {% for notice in notices %}
            <li>{{ notice }}</li>
        {% else %}
            <li>No announcements yet.</li>
        {% endfor %}
    </ul>
    <p style="margin-top: 12px; text-align: right;">
        <a href="{{ url_for('announcements') }}" style="color: var(--secondary); font-weight: 600; text-decoration: none;">View all &rarr;</a>
    </p>
</section>

  </div>
</section>
<!-- Make Request Modal -->
<div id="makeRequestModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" id="closeModalBtn">&times;</span>
        <h2>Make a Request</h2>
        <textarea id="requestInput" placeholder="Enter what you want..." rows="5"></textarea>
        <button id="sendRequestBtn" class="btn-primary">Send Request</button>
    </div>
</div>

    </div>

    <script>
        // Carousel data for hostel item sharing
        const carouselData = [
            {
                id: 1,
                title: "Textbooks & Study Materials",
                description: "Share your used textbooks, notes, and study guides with fellow students.",
                tags: ["Education", "Academic", "Books"],
                icon: "book",
                color: "#4fbbd6"
            },
            {
                id: 2,
                title: "Stationery Supplies",
                description: "Exchange pens, notebooks, and other essential academic supplies.",
                tags: ["Study", "Essentials", "School"],
                icon: "pencil-alt",
                color: "#8e44ad"
            },
            {
                id: 3,
                title: "Kitchen Utensils",
                description: "Share pots, pans, and other kitchen items you no longer need.",
                tags: ["Cooking", "Kitchen", "Essentials"],
                icon: "utensils",
                color: "#e74c3c"
            },
            {
                id: 4,
                title: "Electronics & Gadgets",
                description: "Pass on electronics like calculators, lamps, or chargers.",
                tags: ["Tech", "Gadgets", "Electronics"],
                icon: "laptop",
                color: "#2ecc71"
            },
            {
                id: 5,
                title: "Room Decor",
                description: "Exchange posters, plants, and other decorative items for your room.",
                tags: ["Decor", "Home", "Comfort"],
                icon: "couch",
                color: "#f39c12"
            },
            {
                id: 6,
                title: "Sports Equipment",
                description: "Share sports gear like cricket bats, footballs, or badminton rackets.",
                tags: ["Fitness", "Sports", "Recreation"],
                icon: "basketball-ball",
                color: "#e67e22"
            }
        ];

        // Initialize after DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                const loadingScreen = document.getElementById('loadingScreen');
                const mainContent = document.getElementById('mainContent');
                loadingScreen.classList.add('fade-out');
                setTimeout(function() {
                    mainContent.classList.add('visible');
                    initCarousel();
                }, 500);
            }, 4000);
            
            const themeToggle = document.getElementById('themeToggle');
            const themeIcon = themeToggle.querySelector('i');
            
            themeToggle.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                if (document.body.classList.contains('dark-mode')) {
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                } else {
                    themeIcon.classList.remove('fa-sun');
                    themeIcon.classList.add('fa-moon');
                }
            });
            
            const searchBar = document.querySelector('.search-bar');
            searchBar.addEventListener('focus', () => {
                searchBar.placeholder = '';
            });
            searchBar.addEventListener('blur', () => {
                if (searchBar.value === '') {
                    searchBar.placeholder = 'Search for items...';
                }
            });
        });

        // Carousel functionality
        function initCarousel() {
            const carouselContainer = document.getElementById('carouselContainer');
            const carouselDots = document.getElementById('carouselDots');
            const carouselPrev = document.getElementById('carouselPrev');
            const carouselNext = document.getElementById('carouselNext');
            
            let currentIndex = 0;
            let autoRotateInterval;
            let cards = [];
            
            carouselData.forEach((item, index) => {
                const carouselCard = document.createElement('div');
                carouselCard.classList.add('carousel-card');
                if (index === 0) {
                    carouselCard.classList.add('active');
                } else if (index === 1) {
                    carouselCard.classList.add('next');
                } else if (index === carouselData.length - 1) {
                    carouselCard.classList.add('prev');
                } else {
                    carouselCard.classList.add('inactive');
                }
                carouselCard.innerHTML = `
                    <div class="carousel-img" style="background-color: ${item.color}">
                        <i class="fas fa-${item.icon}"></i>
                    </div>
                    <div class="carousel-content">
                        <h3 class="carousel-title">${item.title}</h3>
                        <p class="carousel-desc">${item.description}</p>
                        <div class="carousel-tags">
                            ${item.tags.map(tag => `<span class="carousel-tag">${tag}</span>`).join('')}
                        </div>
                        <a href="#" class="carousel-button">Browse Items</a>
                    </div>
                `;
                carouselContainer.appendChild(carouselCard);
                cards.push(carouselCard);
                const dot = document.createElement('button');
                dot.classList.add('carousel-dot');
                if (index === 0) dot.classList.add('active');
                dot.addEventListener('click', () => {
                    goToSlide(index);
                });
                carouselDots.appendChild(dot);
            });
            
            carouselPrev.addEventListener('click', () => {
                goToSlide(currentIndex - 1);
            });
            carouselNext.addEventListener('click', () => {
                goToSlide(currentIndex + 1);
            });
            startAutoRotation();
            carouselContainer.addEventListener('mouseenter', () => {
                clearInterval(autoRotateInterval);
            });
            carouselContainer.addEventListener('mouseleave', () => {
                startAutoRotation();
            });
            
            function goToSlide(index) {
                if (index < 0) index = carouselData.length - 1;
                if (index >= carouselData.length) index = 0;
                currentIndex = index;
                updateCarousel();
            }
            function updateCarousel() {
                const dots = document.querySelectorAll('.carousel-dot');
                cards.forEach((card, index) => {
                    card.classList.remove('active', 'next', 'prev', 'inactive');
                    if (index === currentIndex) {
                        card.classList.add('active');
                    } else if (index === (currentIndex + 1) % carouselData.length) {
                        card.classList.add('next');
                    } else if (index === (currentIndex - 1 + carouselData.length) % carouselData.length) {
                        card.classList.add('prev');
                    } else {
                        card.classList.add('inactive');
                    }
                });
                dots.forEach((dot, index) => {
                    if (index === currentIndex) {
                        dot.classList.add('active');
                    } else {
                        dot.classList.remove('active');
                    }
                });
            }
            function startAutoRotation() {
                clearInterval(autoRotateInterval);
                autoRotateInterval = setInterval(() => {
                    goToSlide(currentIndex + 1);
                }, 4000);
            }
        }
    </script>

    <script>
    const makeRequestBtn = document.getElementById('makeRequestBtn');
    const makeRequestModal = document.getElementById('makeRequestModal');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const sendRequestBtn = document.getElementById('sendRequestBtn');
    const requestInput = document.getElementById('requestInput');

    // Open modal
    makeRequestBtn.addEventListener('click', () => {
        makeRequestModal.style.display = 'flex';
        requestInput.focus();
    });

    // Close modal
    closeModalBtn.addEventListener('click', () => {
        makeRequestModal.style.display = 'none';
        requestInput.value = '';
    });

    // Close modal if clicking outside modal content
    window.addEventListener('click', (e) => {
        if (e.target === makeRequestModal) {
            makeRequestModal.style.display = 'none';
            requestInput.value = '';
        }
    });

    // Send request click
    sendRequestBtn.addEventListener('click', () => {
        const requestText = requestInput.value.trim();
        if (requestText.length === 0) {
            alert('Please enter a request.');
            return;
        }
        // TODO: Send the request to backend via fetch or form submission here
        alert(`Request sent: ${requestText}`);
        makeRequestModal.style.display = 'none';
        requestInput.value = '';
    });

    document.getElementById('loginBtn').addEventListener('click', () => {
    alert('Show login modal or redirect to login page here.');
});

document.getElementById('addToCartBtn').addEventListener('click', () => {
    alert('Show cart summary or navigate to cart page.');
});

</script>

<script>
    const announcementBtn = document.getElementById('announcementBtn');
    const announcementContent = document.getElementById('announcementContent');
    const announcementList = document.getElementById('announcementList');

    // Example announcements you may pass from backend or define here
    const announcements = [
        "Need a calculator for physics lab.",
        "Looking for a used ballpoint pen.",
        "Extension cords available for sharing.",
        "Offering used textbooks in good condition."
    ];

    // Populate announcement list
    announcements.forEach(text => {
        const li = document.createElement('li');
        li.textContent = text;
        announcementList.appendChild(li);
    });

    // Toggle dropdown show/hide
    announcementBtn.addEventListener('click', () => {
        if (announcementContent.style.display === 'none' || announcementContent.style.display === '') {
            announcementContent.style.display = 'block';
        } else {
            announcementContent.style.display = 'none';
        }
    });

    // Close dropdown if clicked outside
    window.addEventListener('click', function(event) {
        if (!announcementBtn.contains(event.target) && !announcementContent.contains(event.target)) {
            announcementContent.style.display = 'none';
        }
    });
</script>

<script>
    const notificationBtn = document.getElementById('notificationBtn');
    const notificationContent = document.getElementById('notificationContent');
    const notificationList = document.getElementById('notificationList');

    // Sample notification messages
    const notifications = [
        "Alice requested a calculator.",
        "New item added to Stationery Pack.",
        "Event: E-waste drive next Monday!"
    ];

    // Populate notifications list
    notifications.forEach(text => {
        const li = document.createElement('li');
        li.textContent = text;
        notificationList.appendChild(li);
    });

    // Toggle dropdown visibility on bell click
    notificationBtn.addEventListener('click', () => {
        if (notificationContent.style.display === 'block') {
            notificationContent.style.display = 'none';
        } else {
            notificationContent.style.display = 'block';
        }
    });

    // Hide dropdown if click outside
    window.addEventListener('click', (e) => {
        if (!notificationBtn.contains(e.target) && !notificationContent.contains(e.target)) {
            notificationContent.style.display = 'none';
        }
    });
</script>

<footer style="background: var(--header-bg); padding: 30px 5%; margin-top: 50px; box-shadow: 0 -2px 15px var(--shadow); color: var(--text); font-size: 0.95rem;">
  <div style="max-width: 1200px; margin: auto; display: flex; flex-wrap: wrap; justify-content: space-between; gap: 20px;">
    
    <div style="flex: 1 1 220px; min-width: 200px;">
      <h3 style="color: var(--primary); margin-bottom: 12px;">PassItOn</h3>
      <p>Sharing community marketplace for hostel students. Give what you don't need, get what you do.</p>
    </div>

    <div style="flex: 1 1 150px; min-width: 140px;">
      <h4 style="margin-bottom: 12px;">Quick Links</h4>
      <ul style="list-style: none; padding: 0; margin: 0;">
        <li><a href="/" style="color: var(--text); text-decoration: none;">Home</a></li>
        <li><a href="/announcements" style="color: var(--text); text-decoration: none;">Announcements</a></li>
        <li><a href="/common-items" style="color: var(--text); text-decoration: none;">Common Items</a></li>
        <li><a href="/requests" style="color: var(--text); text-decoration: none;">Requests</a></li>
      </ul>
    </div>

    <div style="flex: 1 1 220px; min-width: 200px;">
      <h4 style="margin-bottom: 12px;">Contact Us</h4>
      <p>Email: support@passiton.com</p>
      <p>Phone: +1 234 567 890</p>
      <p>Hostel Lounge, Example University</p>
    </div>
  </div>

  <div style="text-align: center; margin-top: 20px; font-size: 0.85rem; color: #777;">
    &copy; {{ current_year }} PassItOn. All rights reserved.
  </div>
</footer>

</body>
</html>
