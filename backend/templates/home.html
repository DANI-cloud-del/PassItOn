<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PassItOn - Share What You Don't Need</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='carousel.css') }}">
    <!-- No carousel-related CSS in the style tag -->
</head>
<body>
    <!-- Initial loading screen with motto -->
    <div class="loading-screen" id="loadingScreen">
        <div class="motto-container">
            {% if show_motto %}
                <div class="motto">
                    {% if session.get('username') %}
                        <p>Welcome back, {{ session.get('username') }}! Let's make the most of PassItOn.</p>
                    {% else %}
                        <p>Give what you don't need. Get what you do.</p>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
    
    {% include '_navbar.html' %}



    
    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <section class="hero">
            <h1>Welcome to PassItOn</h1>
            <p>A community marketplace for sharing items among hostel students</p>
        </section>
        
        <!-- 3D Carousel Section - Style comes from carousel.css only -->
        <div class="carousel-container" id="carouselContainer">
            <!-- Carousel cards will be loaded here -->
            
            <button class="carousel-nav-btn prev" id="carouselPrev">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="carousel-nav-btn next" id="carouselNext">
                <i class="fas fa-chevron-right"></i>
            </button>
            
            <div class="carousel-dots" id="carouselDots">
                <!-- Navigation dots will be loaded here -->
            </div>
        </div>
        <section class="top-deals-section" 
  style="
    margin-top: 96px;
    padding: 44px 3%;
    background: var(--card-bg);
    border-radius: 22px;
    box-shadow: 0 6px 36px rgba(0,0,0,0.26), 0 1.5px 3px rgba(0,0,0,0.21);
    max-width: 1300px;
    margin-left: auto;
    margin-right: auto;
    border: 1.5px solid var(--primary);
    ">
  <h2 class="section-title" 
      style="
        color: var(--primary);
        font-size: 2.3rem;
        text-align: center;
        margin-top: 0;
        margin-bottom: 24px;
        font-weight: 800;
        letter-spacing: 1px;
        text-shadow: 0 2px 16px var(--shadow);
      ">
    Top Deals
  </h2>
  <div style="
        max-width: 1200px;
        margin: 18px auto 16px auto;
        text-align: right;">
    <a href="{{ url_for('sell_item') }}" class="btn-primary"
      style="
        padding: 10px 22px;
        border-radius: 27px;
        font-weight: 600;
        text-decoration: none;
        font-size: 1.09rem;
        background: var(--primary);
        color: #fff;
        box-shadow: 0 2px 12px var(--shadow);
        transition: background 0.2s;">
      <i class="fas fa-plus"></i>
      Sell Your Items
    </a>
  </div>
  <div class="deals-container"
    style="
      display: flex;
      flex-wrap: wrap;
      gap: 36px 24px;
      justify-content: center;
      align-items: stretch;
      margin: 0 auto;">
    {% for deal in top_deals %}
      <div class="deal-card"
        style="
          background: #221E39;
          color: #f7f7fa;
          border-radius: 16px;
          box-shadow: 0 8px 32px var(--shadow);
          max-width: 270px;
          padding: 0 0 18px 0;
          flex: 1 0 260px;
          min-width: 240px;
          min-height: 290px;
          display: flex;
          flex-direction: column;
          transition: box-shadow 0.22s, transform 0.16s;
          border: 1.5px solid var(--primary);
        ">
        <div class="deal-img" style="
          background-color: {{ deal.color }};
          height: 110px;
          border-radius: 16px 16px 0 0;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 2.6rem;
          color: #fff;
          margin-bottom: 0;
        ">
          <i class="fas fa-{{ deal.icon }}"></i>
        </div>
        <div class="deal-details" 
          style="padding: 18px 20px 8px 20px;
                 display: flex; flex-direction: column; flex: 1 1 auto; gap: 8px;">
          <h3 style="font-size: 1.15rem; font-weight: 700; margin-bottom: 3px; color: #fff;">
            {{ deal.title }}
          </h3>
          <p style="
            font-size: 0.99rem;
            color: #e7e7fb;
            opacity: 0.87;
            flex: 1 1 auto;
            margin: 0 0 9px 0;">
            {{ deal.description }}
          </p>
          <a href="#" class="deal-button"
            style="
              margin-top: auto;
              background: var(--primary);
              color: #fff;
              padding: 12px 0;
              width: 100%;
              border-radius: 8px;
              font-weight: 700;
              font-size: 1.06rem;
              text-align: center;
              text-decoration: none;
              box-shadow: 0 1.5px 5px var(--shadow);
              transition: background 0.18s;">
            Grab Deal
          </a>
        </div>
      </div>
    {% endfor %}
  </div>
</section>




    <section class="announcement-box" 
  style="
    max-width: 900px;
    margin: 40px auto 0 auto;
    padding: 32px 28px 18px 28px;
    background: #221E39;
    border-radius: 16px;
    box-shadow: 0 6px 30px var(--shadow);
    border: 1.5px solid var(--primary);
    ">
  <h3 style="color: var(--secondary); 
           margin-bottom: 18px; 
           font-size: 1.4rem;
           text-align: center;
           letter-spacing: 0.75px;
           font-weight: 700;">
    Latest Announcements
  </h3>
  <ul style="
    list-style: disc inside;
    color: #f7f7fa;
    max-height: 160px;
    overflow-y: auto;
    font-size: 1.05rem;
    padding-left: 10px;">
    {% for notice in notices %}
      <li style="margin-bottom: 7px; line-height: 1.6;">{{ notice }}</li>
    {% else %}
      <li>No announcements yet.</li>
    {% endfor %}
  </ul>
  <p style="margin-top: 12px; text-align: right;">
    <a href="{{ url_for('announcements') }}" 
      style="color: var(--accent); font-weight: 600; text-decoration: none;">
      View all &rarr;
    </a>
  </p>
</section>


  </div>
</section>
    </div>

    <script>
        // Carousel data for hostel item sharing
        const carouselData = [
            {
                id: 1,
                title: "Textbooks & Study Materials",
                description: "Share your used textbooks, notes, and study guides with fellow students.",
                tags: ["Education", "Academic", "Books"],
                icon: "book",
                color: "#4fbbd6"
            },
            {
                id: 2,
                title: "Stationery Supplies",
                description: "Exchange pens, notebooks, and other essential academic supplies.",
                tags: ["Study", "Essentials", "School"],
                icon: "pencil-alt",
                color: "#8e44ad"
            },
            {
                id: 3,
                title: "Kitchen Utensils",
                description: "Share pots, pans, and other kitchen items you no longer need.",
                tags: ["Cooking", "Kitchen", "Essentials"],
                icon: "utensils",
                color: "#e74c3c"
            },
            {
                id: 4,
                title: "Electronics & Gadgets",
                description: "Pass on electronics like calculators, lamps, or chargers.",
                tags: ["Tech", "Gadgets", "Electronics"],
                icon: "laptop",
                color: "#2ecc71"
            },
            {
                id: 5,
                title: "Room Decor",
                description: "Exchange posters, plants, and other decorative items for your room.",
                tags: ["Decor", "Home", "Comfort"],
                icon: "couch",
                color: "#f39c12"
            },
            {
                id: 6,
                title: "Sports Equipment",
                description: "Share sports gear like cricket bats, footballs, or badminton rackets.",
                tags: ["Fitness", "Sports", "Recreation"],
                icon: "basketball-ball",
                color: "#e67e22"
            }
        ];

        // Initialize after DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                const loadingScreen = document.getElementById('loadingScreen');
                const mainContent = document.getElementById('mainContent');
                loadingScreen.classList.add('fade-out');
                setTimeout(function() {
                    mainContent.classList.add('visible');
                    initCarousel();
                }, 500);
            }, 4000);
            
            const themeToggle = document.getElementById('themeToggle');
            const themeIcon = themeToggle.querySelector('i');
            
            themeToggle.addEventListener('click', () => {
                document.body.classList.toggle('dark-mode');
                if (document.body.classList.contains('dark-mode')) {
                    themeIcon.classList.remove('fa-moon');
                    themeIcon.classList.add('fa-sun');
                } else {
                    themeIcon.classList.remove('fa-sun');
                    themeIcon.classList.add('fa-moon');
                }
            });
            
            const searchBar = document.querySelector('.search-bar');
            searchBar.addEventListener('focus', () => {
                searchBar.placeholder = '';
            });
            searchBar.addEventListener('blur', () => {
                if (searchBar.value === '') {
                    searchBar.placeholder = 'Search for items...';
                }
            });
        });

        // Carousel functionality
        function initCarousel() {
            const carouselContainer = document.getElementById('carouselContainer');
            const carouselDots = document.getElementById('carouselDots');
            const carouselPrev = document.getElementById('carouselPrev');
            const carouselNext = document.getElementById('carouselNext');
            
            let currentIndex = 0;
            let autoRotateInterval;
            let cards = [];
            
            carouselData.forEach((item, index) => {
                const carouselCard = document.createElement('div');
                carouselCard.classList.add('carousel-card');
                if (index === 0) {
                    carouselCard.classList.add('active');
                } else if (index === 1) {
                    carouselCard.classList.add('next');
                } else if (index === carouselData.length - 1) {
                    carouselCard.classList.add('prev');
                } else {
                    carouselCard.classList.add('inactive');
                }
                carouselCard.innerHTML = `
                    <div class="carousel-img" style="background-color: ${item.color}">
                        <i class="fas fa-${item.icon}"></i>
                    </div>
                    <div class="carousel-content">
                        <h3 class="carousel-title">${item.title}</h3>
                        <p class="carousel-desc">${item.description}</p>
                        <div class="carousel-tags">
                            ${item.tags.map(tag => `<span class="carousel-tag">${tag}</span>`).join('')}
                        </div>
                        <a href="#" class="carousel-button">Browse Items</a>
                    </div>
                `;
                carouselContainer.appendChild(carouselCard);
                cards.push(carouselCard);
                const dot = document.createElement('button');
                dot.classList.add('carousel-dot');
                if (index === 0) dot.classList.add('active');
                dot.addEventListener('click', () => {
                    goToSlide(index);
                });
                carouselDots.appendChild(dot);
            });
            
            carouselPrev.addEventListener('click', () => {
                goToSlide(currentIndex - 1);
            });
            carouselNext.addEventListener('click', () => {
                goToSlide(currentIndex + 1);
            });
            startAutoRotation();
            carouselContainer.addEventListener('mouseenter', () => {
                clearInterval(autoRotateInterval);
            });
            carouselContainer.addEventListener('mouseleave', () => {
                startAutoRotation();
            });
            
            function goToSlide(index) {
                if (index < 0) index = carouselData.length - 1;
                if (index >= carouselData.length) index = 0;
                currentIndex = index;
                updateCarousel();
            }
            function updateCarousel() {
                const dots = document.querySelectorAll('.carousel-dot');
                cards.forEach((card, index) => {
                    card.classList.remove('active', 'next', 'prev', 'inactive');
                    if (index === currentIndex) {
                        card.classList.add('active');
                    } else if (index === (currentIndex + 1) % carouselData.length) {
                        card.classList.add('next');
                    } else if (index === (currentIndex - 1 + carouselData.length) % carouselData.length) {
                        card.classList.add('prev');
                    } else {
                        card.classList.add('inactive');
                    }
                });
                dots.forEach((dot, index) => {
                    if (index === currentIndex) {
                        dot.classList.add('active');
                    } else {
                        dot.classList.remove('active');
                    }
                });
            }
            function startAutoRotation() {
                clearInterval(autoRotateInterval);
                autoRotateInterval = setInterval(() => {
                    goToSlide(currentIndex + 1);
                }, 4000);
            }
        }
    </script>

<!-- Removed duplicate makeRequestBtn modal script block to avoid redeclaration error. 
     The dropdown-based request logic below is sufficient for handling requests. -->

<script>
    
    document.getElementById('addToCartBtn').addEventListener('click', () => {
        alert('Show cart summary or navigate to cart page.');
    });
</script>

<script>
    const announcementBtn = document.getElementById('announcementBtn');
    const announcementContent = document.getElementById('announcementContent');
    const announcementList = document.getElementById('announcementList');

    // Example announcements you may pass from backend or define here
    const announcements = [
        "Need a calculator for physics lab.",
        "Looking for a used ballpoint pen.",
        "Extension cords available for sharing.",
        "Offering used textbooks in good condition."
    ];

    // Populate announcement list
    announcements.forEach(text => {
        const li = document.createElement('li');
        li.textContent = text;
        announcementList.appendChild(li);
    });

    // Toggle dropdown show/hide
    announcementBtn.addEventListener('click', () => {
        if (announcementContent.style.display === 'none' || announcementContent.style.display === '') {
            announcementContent.style.display = 'block';
        } else {
            announcementContent.style.display = 'none';
        }
    });

    // Close dropdown if clicked outside
    window.addEventListener('click', function(event) {
        if (!announcementBtn.contains(event.target) && !announcementContent.contains(event.target)) {
            announcementContent.style.display = 'none';
        }
    });
</script>

<script>
    const notificationBtn = document.getElementById('notificationBtn');
    const notificationContent = document.getElementById('notificationContent');
    const notificationList = document.getElementById('notificationList');

    // Sample notification messages
    const notifications = [
        "Alice requested a calculator.",
        "New item added to Stationery Pack.",
        "Event: E-waste drive next Monday!"
    ];

    // Populate notifications list
    notifications.forEach(text => {
        const li = document.createElement('li');
        li.textContent = text;
        notificationList.appendChild(li);
    });

    // Toggle dropdown visibility on bell click
    notificationBtn.addEventListener('click', () => {
        if (notificationContent.style.display === 'block') {
            notificationContent.style.display = 'none';
        } else {
            notificationContent.style.display = 'block';
        }
    });

    // Hide dropdown if click outside
    window.addEventListener('click', (e) => {
        if (!notificationBtn.contains(e.target) && !notificationContent.contains(e.target)) {
            notificationContent.style.display = 'none';
        }
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const makeRequestBtn = document.getElementById('makeRequestBtn');
        const makeRequestContent = document.getElementById('makeRequestContent');
        const requestForm = document.getElementById('requestForm');
        const requestInput = document.getElementById('requestInput');

        if (!makeRequestBtn || !makeRequestContent || !requestForm || !requestInput) {
            console.error('One or more request elements not found');
            return;
        }

        // Toggle dropdown with class instead of display property
        makeRequestBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            makeRequestContent.classList.toggle('show');
            if(makeRequestContent.classList.contains('show')) {
                requestInput.focus();
            }
        });

        // Close dropdown by removing class
        document.addEventListener('click', (e) => {
            if (!makeRequestBtn.contains(e.target) && !makeRequestContent.contains(e.target)) {
                makeRequestContent.classList.remove('show');
            }
        });

        requestForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const requestText = requestInput.value.trim();
            if(!requestText) {
                alert('Please enter a request');
                return;
            }
            alert(`Request sent: ${requestText}`);
            makeRequestContent.classList.remove('show');
            requestInput.value = '';
        });
    });
</script>

<script>
    
    document.addEventListener("DOMContentLoaded", function () {
  const logoutBtn = document.getElementById("logoutBtn");
  if (logoutBtn) {
    logoutBtn.addEventListener("click", function () {
      window.location.href = "/logout";
    });
  }
});

</script>


<footer style="background: var(--header-bg); padding: 30px 5%; margin-top: 50px; box-shadow: 0 -2px 15px var(--shadow); color: var(--text); font-size: 0.95rem;">
  <div style="max-width: 1200px; margin: auto; display: flex; flex-wrap: wrap; justify-content: space-between; gap: 20px;">
    
    <div style="flex: 1 1 220px; min-width: 200px;">
      <h3 style="color: var(--primary); margin-bottom: 12px;">PassItOn</h3>
      <p>Sharing community marketplace for hostel students. Give what you don't need, get what you do.</p>
    </div>

    <div style="flex: 1 1 150px; min-width: 140px;">
      <h4 style="margin-bottom: 12px;">Quick Links</h4>
      <ul style="list-style: none; padding: 0; margin: 0;">
        <li><a href="/" style="color: var(--text); text-decoration: none;">Home</a></li>
        <li><a href="/announcements" style="color: var(--text); text-decoration: none;">Announcements</a></li>
        <li><a href="/common-items" style="color: var(--text); text-decoration: none;">Common Items</a></li>
        <li><a href="/requests" style="color: var(--text); text-decoration: none;">Requests</a></li>
      </ul>
    </div>

    <div style="flex: 1 1 220px; min-width: 200px;">
      <h4 style="margin-bottom: 12px;">Contact Us</h4>
      <p>Email: support@passiton.com</p>
      <p>Phone: +1 234 567 890</p>
      <p>Hostel Lounge, Example University</p>
    </div>
  </div>

  <div style="text-align: center; margin-top: 20px; font-size: 0.85rem; color: #777;">
    &copy; {{ current_year }} PassItOn. All rights reserved.
  </div>
</footer>

</body>
</html>
